# ERC721 & í¬ë¦½í†  ìˆ˜ì§‘í’ˆ

### ì´ë”ë¦¬ì›€ ìƒì˜ í† í°

- **í† í°** : ê¸°ë³¸ì ìœ¼ë¡œ ê·¸ì € ëª‡ëª‡ ê³µí†µ ê·œì•½ì„ ë”°ë¥´ëŠ” ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸. ì¦‰, ë‹¤ë¥¸ ëª¨ë“  í† ã„±í° ì»¨íŠ¸ë™íŠ¸ê°€ ì‚¬ìš©í•˜ëŠ” í‘œì¤€ í•¨ìˆ˜ ì§‘í•©ì„ êµ¬í˜„í•œê²ƒ
    - ì˜ˆë¥¼ ë“¤ë©´ `transfer(address _to, uint256 _value)`ë‚˜Â `balanceOf(address _owner)`ê°™ì€ í•¨ìˆ˜ë“¤ì´ ìˆìŒ.
    - ë‚´ë¶€ì ìœ¼ë¡œ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ëŠ” ë³´í†µÂ `mapping(address => uint256) balances`ì™€ ê°™ì€ ë§¤í•‘ì„ ê°€ì§€ê³  ìˆìŒ. ê°ê°ì˜ ì£¼ì†Œì— ì”ì•¡ì´ ì–¼ë§ˆë‚˜ ìˆëŠ”ì§€ ê¸°ë¡.
    - ë³¸ì ìœ¼ë¡œ í† í°ì€ ê·¸ì € í•˜ë‚˜ì˜ ì»¨íŠ¸ë™íŠ¸. ê·¸ ì•ˆì—ì„œ ëˆ„ê°€ ì–¼ë§ˆë‚˜ ë§ì€ í† í°ì„ ê°€ì§€ê³  ìˆëŠ”ì§€ ê¸°ë¡í•˜ê³ , ëª‡ëª‡ í•¨ìˆ˜ë¥¼ ê°€ì§€ê³  ì‚¬ìš©ìë“¤ì´ ê·¸ë“¤ì˜ í† í°ì„ ë‹¤ë¥¸ ì£¼ì†Œë¡œ ì „ì†¡í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê²ƒ.
- ì´ë ‡ê²Œ í•˜ëŠ” ì´ìœ 
    - ëª¨ë“  ERC20 í† í°ë“¤ì´ ë˜‘ê°™ì€ ì´ë¦„ì˜ ë™ì¼í•œ í•¨ìˆ˜ ì§‘í•©ì„ ê³µìœ í•˜ê¸° ë•Œë¬¸ì—, ì´ í† í°ë“¤ì— ë˜‘ê°™ì€ ë°©ì‹ìœ¼ë¡œ ìƒí˜¸ì‘ìš©ì´ ê°€ëŠ¥
    - ì¦‰ ìë„¤ê°€ í•˜ë‚˜ì˜ ERC20 í† í°ê³¼ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ í•˜ë‚˜ë¥¼ ë§Œë“¤ë©´, ì´ ì•±ì´ ë‹¤ë¥¸ ì–´ë–¤ ERC20 í† í°ê³¼ë„ ìƒí˜¸ì‘ìš©ì´ ê°€ëŠ¥
        - ë°©ì‹ìœ¼ë¡œ ì»¤ìŠ¤í…€ ì½”ë“œë¥¼ ì¶”ê°€í•˜ì§€ ì•Šê³  ì•±ì— ë” ë§ì€ í† í°ë“¤ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŒ
        - ê·¸ì € ìƒˆë¡œìš´ í† í°ì˜ ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œë§Œ ë¼ì›Œë„£ìœ¼ë©´ ë¨
    - ì˜ˆë¡œëŠ” ê±°ë˜ì†Œê°€ ìˆìŒ
        - í•œ ê±°ë˜ì†Œì—ì„œ ìƒˆë¡œìš´ ERC20 í† í°ì„ ìƒì¥í•  ë•Œ, ì‹¤ì œë¡œëŠ” ì´ ê±°ë˜ì†Œì—ì„œ í†µì‹ ì´ ê°€ëŠ¥í•œ ë˜ í•˜ë‚˜ì˜ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒ
        - ì‚¬ìš©ìë“¤ì€ ì´ ì»¨íŠ¸ë™íŠ¸ì— ê±°ë˜ì†Œì˜ ì§€ê°‘ ì£¼ì†Œì— í† í°ì„ ë³´ë‚´ë¼ê³  í•  ìˆ˜ ìˆìŒ
        - ê±°ë˜ì†Œì—ì„œëŠ” ì´ ì»¨íŠ¸ë™íŠ¸ì— ì‚¬ìš©ìë“¤ì´ ì¶œê¸ˆì„ ì‹ ì²­í•˜ë©´ í† í°ì„ ë‹¤ì‹œ ëŒë ¤ë³´ë‚´ë¼ê³  í•  ìˆ˜ ìˆê²Œ ë§Œë“œëŠ” ê²ƒ.
    - ê±°ë˜ì†Œì—ì„œëŠ” ì´ ì „ì†¡ ë¡œì§ì„ í•œ ë²ˆë§Œ êµ¬í˜„í•˜ë©´ ë¨. ê·¸ë¦¬ê³  ìƒˆë¡œìš´ ERC20í† í°ì„ ì¶”ê°€ í•˜ê³  ì‹¶ìœ¼ë©´, ë°ì´í„°ë² ì´ìŠ¤ì— ë‹¨ìˆœíˆ ìƒˆ ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œë¥¼ ì¶”ê°€ë§Œ í•˜ë©´ë¨
- ë‹¤ë¥¸ í† í¬ í‘œì¤€
    - ERC20 í† í°ì€ í™”íì²˜ëŸ¼ ì‚¬ìš©ë˜ëŠ” í† í°ìœ¼ë¡œëŠ” ì •ë§ ì ì ˆ. ê·¸ëŸ¬ë‚˜ ì¢€ë¹„ ê²Œì„ì€ ë¶€ì ì ˆ
        - ì²«ì§¸ë¡œ, ì¢€ë¹„ëŠ” í™”íì²˜ëŸ¼ ë¶„í• í•  ìˆ˜ê°€ ì—†ìŒ - 0.237ETHë¥¼ ë³´ë‚¼ ìˆ˜ ìˆì§€ë§Œ, 0.237ê°œì˜ ì¢€ë¹„ë¥¼ ë³´ë‚´ëŠ” ê²ƒì€ ë§ì´ ë˜ì§€ ì•ŠìŒ.
        - ë‘˜ì§¸ë¡œ, ëª¨ë“  ì¢€ë¹„ê°€ ë˜‘ê°™ì§€ëŠ” ì•ŠìŒ. ìë„¤ì˜ ë ˆë²¨2 ì¢€ë¹„ "**Steve**"ëŠ” ë‚´ ë ˆë²¨732 ì¢€ë¹„ "**H4XF13LD MORRIS**"ì™€ëŠ” ì™„ì „íˆ ë‹¤ë¦„.
    - **ERC721 í† í°**
        - ***ERC721 í† í°***ì€ êµì²´ê°€Â **ë¶ˆê°€** (ê°ê°ì˜ í† í°ì´ ìœ ì¼í•˜ê³  ë¶„í• ì´ ë¶ˆê°€)
        - ì´ í† í°ì„ í•˜ë‚˜ì˜ ì „ì²´ ë‹¨ìœ„ë¡œë§Œ ê±°ë˜í•  ìˆ˜ ìˆê³ , ê°ê°ì˜ í† í°ì€ ìœ ì¼í•œ IDë¥¼ ê°€ì§€ê³  ìˆìŒ
        
        > *ERC721ê³¼ ê°™ì€ í‘œì¤€ì„ ì‚¬ìš©í•˜ë©´ ìš°ë¦¬ì˜ ì»¨íŠ¸ë™íŠ¸ì—ì„œ ì‚¬ìš©ìë“¤ì´ ìš°ë¦¬ì˜ ì¢€ë¹„ë¥¼ ê±°ë˜/íŒë§¤í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²½ë§¤ë‚˜ ì¤‘ê³„ ë¡œì§ì„ ìš°ë¦¬ê°€ ì§ì ‘ êµ¬í˜„í•˜ì§€ ì•Šì•„ë„ ëœë‹¤ëŠ” ì´ì ì´ ìˆë„¤. ìš°ë¦¬ê°€ ìŠ¤í™ì— ë§ì¶”ê¸°ë§Œ í•˜ë©´, ëˆ„êµ°ê°€ ERC721 ìì‚°ì„ ê±°ë˜í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê±°ë˜ì†Œ í”Œë«í¼ì„ ë§Œë“¤ë©´ ìš°ë¦¬ì˜ ERC721 ì¢€ë¹„ë“¤ì„ ê·¸ í”Œë«í¼ì—ì„œ ì“¸ ìˆ˜ ìˆê²Œ ë  ê²ƒì´ë„¤. ê·¸ëŸ¬ë‹ˆ ìë„¤ë§Œì˜ ê±°ë˜ ë¡œì§ì„ ë§Œë“œëŠë¼ ê³ ìƒí•˜ëŠ” ê²ƒë³´ë‹¤ í† í° í‘œì¤€ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ëª…í™•í•œ ì´ì ì´ ìˆëŠ” ê²ƒì´ì§€.*
        > 
- ì˜ˆì œ) ë‹¤ìŒ ì±•í„°ì—ì„œ ERC721ì„ êµ¬í˜„í•˜ê¸° ì‹œì‘í•  ê²ƒ. ê·¸ì „ì— ë¨¼ì €, ì´ë²ˆ ë ˆìŠ¨ì„ ìœ„í•œ íŒŒì¼ êµ¬ì¡° ìƒì„±. ëª¨ë“  ERC721 ë¡œì§ì„Â `ZombieOwnership`ì´ë¼ëŠ” ì»¨íŠ¸ë™íŠ¸ì— ì €ì¥
    1. íŒŒì¼ì˜ ìµœìƒë‹¨ì—Â `pragma`Â ë²„ì „ì„ ì„ ì–¸í•˜ê²Œ(ë¬¸ë²•ì€ ì´ì „ ë ˆìŠ¨ì˜ íŒŒì¼ì—ì„œ ì°¸ê³ í•˜ê²Œ).
    2. ì´ íŒŒì¼ì€Â `zombieattack.sol`ì„Â `import`Â í•´ì•¼ í•˜ë„¤.
    3. `ZombieOwnership`ì´ë¼ëŠ” ìƒˆë¡œìš´ ì»¨íŠ¸ë™íŠ¸ë¥¼ ì„ ì–¸í•˜ê³ ,Â `ZombieAttack`ì„ ìƒì†í•˜ê²Œ. ì»¨íŠ¸ë™íŠ¸ì˜ ë‚´ìš©ì€ ì§€ê¸ˆ ë‹¹ì¥ì€ ë¹„ì›Œë‘ê²Œ.
    - ì˜ˆì œ ì½”ë“œ
        
        ```solidity
        // ì—¬ê¸°ì„œ ì‹œì‘
        pragma solidity ^0.4.19;
        
        import "./zombieattack.sol";
        
        contract ZombieOwnership is ZombieAttack {
            
        }
        ```
        

### ERC721 í‘œì¤€, ë‹¤ì¤‘ ìƒì†

- ERCí‘œì¤€
    - êµ¬í˜„í•´ì•¼í•  ë©”ì†Œë“œ ëª©ë¡
    
    ```solidity
    contract ERC721 {
      event Transfer(address indexed _from, address indexed _to, uint256 _tokenId);
      event Approval(address indexed _owner, address indexed _approved, uint256 _tokenId);
    
      function balanceOf(address _owner) public view returns (uint256 _balance);
      function ownerOf(uint256 _tokenId) public view returns (address _owner);
      function transfer(address _to, uint256 _tokenId) public;
      function approve(address _to, uint256 _tokenId) public;
      function takeOwnership(uint256 _tokenId) public;
    }
    ```
    
    > *ì°¸ê³ : **ERC721** í‘œì¤€ì€ í˜„ì¬Â ì´ˆì•ˆì¸ ìƒíƒœì´ê³ , ì•„ì§ ê³µì‹ìœ¼ë¡œ ì±„íƒëœ êµ¬í˜„ ë²„ì „ì€ ì—†ë„¤. ì´ íŠœí† ë¦¬ì–¼ì—ì„œ ìš°ë¦¬ëŠ” **OpenZeppelin** ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì“°ì´ëŠ” í˜„ì¬ ë²„ì „ì„ ì‚¬ìš©í•  ê²ƒì´ì§€ë§Œ, ê³µì‹ ë¦´ë¦¬ì¦ˆ ì´ì „ì— ì–¸ì  ê°€ ë°”ë€” ê°€ëŠ¥ì„±ë„ ìˆë„¤. ê·¸ëŸ¬ë‹ˆÂ í•˜ë‚˜ì˜ êµ¬í˜„ ê°€ëŠ¥í•œ ë²„ì „ ì •ë„ë¡œë§Œ ìƒê°í•˜ê³ , ERC721 í† í°ì˜ ì •ì‹ í‘œì¤€ìœ¼ë¡œ ìƒê°í•˜ì§€ëŠ” ë§ê²Œ.*
    > 
- í† í° ì»¨íŠ¸ë™íŠ¸ êµ¬í˜„
    - í† í° ì»¨íŠ¸ë™íŠ¸ë¥¼ êµ¬í˜„í•  ë•Œ, ì²˜ìŒ í•´ì•¼í•  ì¼ã…‡ëŠ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì†”ë¦¬ë””í‹° íŒŒì¼ë¡œ ë”°ë¡œ ë³µì‚¬í•˜ì—¬ ì €ì¥í•˜ê³  `import "./erc721.sol";`ì„ ì¨ì„œ ì„í¬íŠ¸ë¥¼ í•´ì•¼í•¨.
    - í•´ë‹¹ ì»¨íŠ¸ë™íŠ¸ë¥¼ ìƒì†í•˜ëŠ” ìš°ë¦¬ì˜ ì»¨íŠ¸ë™íŠ¸ë¥¼ ë§Œë“¤ê³ , ê°ê°ì˜ í•¨ìˆ˜ë¥¼ ì˜¤ë²„ë¼ì´ë”©í•˜ì—¬ ì •ì˜
- ë‹¤ì¤‘ ìƒì†
    - ë‹¤ìˆ˜ì˜ ì»¨íŠ¸ë™íŠ¸ë¥¼ ìƒì†í•  ìˆ˜ ìˆìŒ
        
        ```solidity
        contract SatoshiNakamoto is NickSzabo, HalFinney {
        }
        ```
        
        - ë‹¤ì¤‘ ìƒì†ì„ ì“¸ ë•ŒëŠ” ìƒì†í•˜ê³ ì í•˜ëŠ” ë‹¤ìˆ˜ì˜ ì»¨íŠ¸ë™íŠ¸ë¥¼ ì‰¼í‘œ(`,`)ë¡œ êµ¬ë¶„í•˜ë©´ ë¨.
- ì˜ˆì œ)
    1. `erc721.sol`Â íŒŒì¼ì„Â `zombieownership.sol`Â íŒŒì¼ì—ì„œ ì„í¬íŠ¸í•˜ê²Œ.
    2. `ZombieOwnership`ì´Â `ZombieAttack`ê³¼Â `ERC721`ì„ ìƒì†í•œë‹¤ê³  ì„ ì–¸í•˜ê²Œ.
    - ì˜ˆì œ ì½”ë“œ
        
        ```solidity
        pragma solidity ^0.4.19;
        
        import "./zombieattack.sol";
        // ì—¬ê¸°ì„œ import í•˜ê²Œ.
        import "./erc721.sol";
        
        // ì—¬ê¸°ì„œ ERC721 ìƒì†ì„ ì„ ì–¸í•˜ê²Œ.
        contract ZombieOwnership is ZombieAttack, ERC721 {
        
        }
        ```
        

### ****balanceOf & ownerOf****

- **balanceOf**
    
    ```solidity
    function balanceOf(address _owner) public view returns (uint256 _balance);
    ```
    
    - ë‹¨ìˆœíˆÂ `address`ë¥¼ ë°›ì•„, í•´ë‹¹Â `address`ê°€ í† í°ì„ ì–¼ë§ˆë‚˜ ê°€ì§€ê³  ìˆëŠ”ì§€ ë°˜í™˜
- **ownerOf**
    
    ```solidity
    function ownerOf(uint256 _tokenId) public view returns (address _owner);
    ```
    
    - í† í° ID(ìš°ë¦¬ì˜ ê²½ìš°ì—ëŠ” ì¢€ë¹„ ID)ë¥¼ ë°›ì•„, ì´ë¥¼ ì†Œìœ í•˜ê³  ìˆëŠ” ì‚¬ëŒì˜Â `address`ë¥¼ ë°˜í™˜
    - ì´ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ”Â `mapping`ì„ ìš°ë¦¬ DAppì— ì´ë¯¸ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— ì´ í•¨ìˆ˜ë“¤ì€ ë‹¨ í•œ ì¤„ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆìŒ.Â `return`ë¬¸ì¥ í•˜ë‚˜ë¡œ ê°€ëŠ¥.
- ì˜ˆì œ)ê°ê°ì˜ í•¨ìˆ˜ëŠ”Â `return`ì„ ì“°ëŠ” ë”± 1ì¤„ì˜ ì½”ë“œë¡œë§Œ êµ¬ì„±. ì´ì „ ë ˆìŠ¨ë“¤ì—ì„œ ì½”ë“œë¥¼ ì‚´í´ë³´ê³  ìš°ë¦¬ê°€ ì´ ë°ì´í„°ë“¤ì„ ì–´ë””ì— ì €ì¥í•˜ëŠ”ì§€ í™•ì¸.
    1. `_owner`ê°€ ê°€ì§„ ì¢€ë¹„ì˜ ìˆ˜ë¥¼ ë°˜í™˜í•˜ë„ë¡Â `balanceOf`ë¥¼ êµ¬í˜„í•˜ê²Œ.
    2. IDê°€Â `_tokenId`ì¸ ì¢€ë¹„ë¥¼ ê°€ì§„ ì£¼ì†Œë¥¼ ë°˜í™˜í•˜ë„ë¡Â `ownerOf`ë¥¼ êµ¬í˜„í•˜ê²Œ. 
    - ì˜ˆì œ ì½”ë“œ
        
        ```solidity
        pragma solidity ^0.4.19;
        
        import "./zombieattack.sol";
        import "./erc721.sol";
        
        contract ZombieOwnership is ZombieAttack, ERC721 {
        
          function balanceOf(address _owner) public view returns (uint256 _balance) {
            // 1. ì—¬ê¸°ì„œ `_owner`ê°€ ê°€ì§„ ì¢€ë¹„ì˜ ìˆ˜ë¥¼ ë°˜í™˜í•˜ê²Œ.
            return ownerZombieCount[_owner];
          }
        
          function ownerOf(uint256 _tokenId) public view returns (address _owner) {
            // 2. ì—¬ê¸°ì„œ `_tokenId`ì˜ ì†Œìœ ìë¥¼ ë°˜í™˜í•˜ê²Œ.
            return zombieToOwner[_tokenId];
          }
        
          function transfer(address _to, uint256 _tokenId) public {
        
          }
        
          function approve(address _to, uint256 _tokenId) public {
        
          }
        
          function takeOwnership(uint256 _tokenId) public {
        
          }
        }
        ```
        

### ë¦¬íŒ©í† ë§

- `zombiefeeding.sol`ì—ì„œÂ `ownerOf`ì™€ ë˜‘ê°™ì€ ì´ë¦„ì˜Â `modifier`ë¥¼ ë§Œë“¤ì–´ì„œ ì»´íŒŒì¼ ì˜¤ë¥˜
    - `ZombieOwnership`ì˜ í•¨ìˆ˜ ì´ë¦„ì„ ë‹¤ë¥¸ ê±¸ë¡œ ë°”ê¿€ìˆ˜ëŠ” ì—†ìŒ
        - ERC721 í† í° í‘œì¤€ì„ ì‚¬ìš©. ì¦‰ ë‹¤ë¥¸ ì»¨íŠ¸ë™íŠ¸ë“¤ì´ ìš°ë¦¬ì˜ ì»¨íŠ¸ë™íŠ¸ê°€ ì •í™•í•œ ì´ë¦„ìœ¼ë¡œ ì •ì˜ëœ í•¨ìˆ˜ë“¤ì„ ê°€ì§€ê³  ìˆì„ ê²ƒì´ë¼ ì˜ˆìƒí•œë‹¤ëŠ” ê²ƒ
        - ë§Œì•½ ìš°ë¦¬ ì»¨íŠ¸ë™íŠ¸ëŠ” ERC721ì„ ë”°ë¥¸ë‹¤ëŠ” ê²ƒì„ ë‹¤ë¥¸ ì»¨íŠ¸ë™íŠ¸ê°€ ì•ˆë‹¤ë©´, ì´ ë‹¤ë¥¸ ì»¨íŠ¸ë™íŠ¸ëŠ” ìš°ë¦¬ì˜ ë‚´ë¶€ êµ¬í˜„ ë¡œì§ì„ ëª¨ë¥´ë”ë¼ë„ ìš°ë¦¬ì™€ í†µì‹ í•  ìˆ˜ ìˆìŒ
    - `modifier`ì˜ ì´ë¦„ì„ ë‹¤ë¥¸ ê²ƒìœ¼ë¡œ ë°”ê¾¸ë„ë¡ ë¦¬íŒ©í† ë§
- ì˜ˆì œ) `zombiefeeding.sol`ë¡œ ëŒì•„ì™€ì„œ,Â `modifier`ì˜ ì´ë¦„ì„Â `ownerOf`ì—ì„œÂ `onlyOwnerOf`ë¡œ ë°”ê¿€ ê²ƒ
    1. ì œì–´ìë¥¼ ì •ì˜í•˜ëŠ” ì´ë¦„ì„Â `onlyOwnerOf`ë¡œ ë°”ê¾¸ê²Œ.
    2. ì´ ì œì–´ìë¥¼ ì‚¬ìš©í•˜ëŠ”Â `feedAndMultiply`Â í•¨ìˆ˜ë¡œ ìŠ¤í¬ë¡¤ì„ ë‚´ë¦¬ê²Œ. ì—¬ê¸°ì„œë„ ê·¸ ì´ë¦„ì„ ë°”ê¿”ì•¼ í•  ê²ƒì´ë„¤.
    - ì˜ˆì œ ì½”ë“œ
        
        ```solidity
        pragma solidity ^0.4.19;
        
        import "./zombiefactory.sol";
        
        contract KittyInterface {
          function getKitty(uint256 _id) external view returns (
            bool isGestating,
            bool isReady,
            uint256 cooldownIndex,
            uint256 nextActionAt,
            uint256 siringWithId,
            uint256 birthTime,
            uint256 matronId,
            uint256 sireId,
            uint256 generation,
            uint256 genes
          );
        }
        
        contract ZombieFeeding is ZombieFactory {
        
          KittyInterface kittyContract;
        
          // 1. ì œì–´ìì˜ ì´ë¦„ì„ `onlyOwnerOf`ë¡œ ë°”ê¾¸ê²Œ.
          modifier onlyOwnerOf(uint _zombieId) {
            require(msg.sender == zombieToOwner[_zombieId]);
            _;
          }
        
          function setKittyContractAddress(address _address) external onlyOwner {
            kittyContract = KittyInterface(_address);
          }
        
          function _triggerCooldown(Zombie storage _zombie) internal {
            _zombie.readyTime = uint32(now + cooldownTime);
          }
        
          function _isReady(Zombie storage _zombie) internal view returns (bool) {
              return (_zombie.readyTime <= now);
          }
        
          // 2. ì—¬ê¸°ì„œë„ ì œì–´ìì˜ ì´ë¦„ì„ ë°”ê¾¸ê²Œ.
          function feedAndMultiply(uint _zombieId, uint _targetDna, string _species) internal onlyOwnerOf(_zombieId) {
            Zombie storage myZombie = zombies[_zombieId];
            require(_isReady(myZombie));
            _targetDna = _targetDna % dnaModulus;
            uint newDna = (myZombie.dna + _targetDna) / 2;
            if (keccak256(_species) == keccak256("kitty")) {
              newDna = newDna - newDna % 100 + 99;
            }
            _createZombie("NoName", newDna);
            _triggerCooldown(myZombie);
          }
        
          function feedOnKitty(uint _zombieId, uint _kittyId) public {
            uint kittyDna;
            (,,,,,,,,,kittyDna) = kittyContract.getKitty(_kittyId);
            feedAndMultiply(_zombieId, kittyDna, "kitty");
          }
        }
        ```
        

### ERC721: ì „ì†¡ë¡œì§

- ìš°ë¦¬ì˜ ERC721ì—ì„œ í•œ ì‚¬ëŒì´ ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ ì†Œìœ ê¶Œì„ ë„˜ê¸°ëŠ” ê²ƒì„ êµ¬í˜„
- ERC721 ìŠ¤í™ì—ì„œëŠ” í† í°ì„ ì „ì†¡í•  ë•Œ 2ê°œì˜ ë‹¤ë¥¸ ë°©ì‹
    
    ```solidity
    function transfer(address _to, uint256 _tokenId) public;
    function approve(address _to, uint256 _tokenId) public;
    function takeOwnership(uint256 _tokenId) public;
    ```
    
    1. ì²« ë²ˆì§¸ ë°©ë²•ì€ í† í°ì˜ ì†Œìœ ìê°€ ì „ì†¡ ìƒëŒ€ì˜Â `address`, ì „ì†¡í•˜ê³ ì í•˜ëŠ”Â `_tokenId`ì™€ í•¨ê»˜Â `transfer`Â í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒì´ë„¤.
    2. ë‘ ë²ˆì§¸ ë°©ë²•ì€ í† í°ì˜ ì†Œìœ ìê°€ ë¨¼ì € ìœ„ì—ì„œ ë³¸ ì •ë³´ë“¤ì„ ê°€ì§€ê³ Â `approve`ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒì´ë„¤. ê·¸ë¦¬ê³ ì„œ ì»¨íŠ¸ë™íŠ¸ì— ëˆ„ê°€ í•´ë‹¹ í† í°ì„ ê°€ì§ˆ ìˆ˜ ìˆë„ë¡ í—ˆê°€ë¥¼ ë°›ì•˜ëŠ”ì§€ ì €ì¥í•˜ì§€. ë³´í†µÂ `mapping (uint256 => address)`ë¥¼ ì¨ì„œ ë§ì´ì§€. ì´í›„ ëˆ„êµ°ê°€Â `takeOwnership`ì„ í˜¸ì¶œí•˜ë©´, í•´ë‹¹ ì»¨íŠ¸ë™íŠ¸ëŠ” ì´Â `msg.sender`ê°€ ì†Œìœ ìë¡œë¶€í„° í† í°ì„ ë°›ì„ ìˆ˜ ìˆê²Œ í—ˆê°€ë¥¼ ë°›ì•˜ëŠ”ì§€ í™•ì¸í•˜ë„¤. ê·¸ë¦¬ê³  í—ˆê°€ë¥¼ ë°›ì•˜ë‹¤ë©´ í•´ë‹¹ í† í°ì„ ê·¸ì—ê²Œ ì „ì†¡í•˜ì§€.
    - `transfer`ì™€Â `takeOwnership`Â ëª¨ë‘ ë™ì¼í•œ ì „ì†¡ ë¡œì§ì„ ê°€ì§€ê³  ìˆìŒ. ìˆœì„œë§Œ ë°˜ëŒ€ì¸ ê²ƒ(ì „ìëŠ” í† í°ì„ ë³´ë‚´ëŠ” ì‚¬ëŒì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œ; í›„ìëŠ” í† í°ì„ ë°›ëŠ” ì‚¬ëŒì´ í˜¸ì¶œí•˜ëŠ” ê²ƒ).
    - ì´ ë¡œì§ë§Œì˜ í”„ë¼ì´ë¹— í•¨ìˆ˜,Â `_transfer`ë¥¼ ë§Œë“¤ì–´ ì¶”ìƒí™”í•˜ëŠ” ê²ƒì´ ì¢‹ì„ ê²ƒ. ë‘ í•¨ìˆ˜ì—ì„œ ëª¨ë‘ ì“¸ ìˆ˜ ìˆìŒ.
- ì˜ˆì œ) `_transfer`ì— ëŒ€í•œ ë¡œì§ì„ ì •ì˜.
    1. `_transfer`ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ê²Œ.Â `address _from`,Â `address _to`, ê·¸ë¦¬ê³ Â `uint256 _tokenId`Â ì„¸ ê°œì˜ ì¸ìˆ˜ë¥¼ ë°›ê³ ,Â `private`Â í•¨ìˆ˜ì´ì–´ì•¼ í•˜ë„¤.
    2. ì†Œìœ ìê°€ ë°”ë€Œë©´ í•¨ê»˜ ë°”ë€” 2ê°œì˜ ë§¤í•‘ì„ ì“¸ ê²ƒì´ë„¤:Â `ownerZombieCount`(í•œ ì†Œìœ ìê°€ ì–¼ë§ˆë‚˜ ë§ì€ ì¢€ë¹„ë¥¼ ê°€ì§€ê³  ìˆëŠ”ì§€ ê¸°ë¡)ì™€Â `zombieToOwner`(ì–´ë–¤ ì¢€ë¹„ë¥¼ ëˆ„ê°€ ê°€ì§€ê³  ìˆëŠ”ì§€ ê¸°ë¡)ì´ë„¤.
        
        ì´ í•¨ìˆ˜ì—ì„œ ì²˜ìŒ í•´ì•¼ í•  ì¼ì€ ë°”ë¡œ ì¢€ë¹„ë¥¼Â **ë°›ëŠ”**Â ì‚¬ëŒ(`address _to`)ì˜Â `ownerZombieCount`ë¥¼ ì¦ê°€ì‹œí‚¤ëŠ” ê²ƒì´ë„¤. ì¦ê°€ì‹œí‚¬ ë•ŒÂ `++`ë¥¼ ì‚¬ìš©í•˜ë„ë¡ í•˜ê²Œ.
        
    3. ë‹¤ìŒìœ¼ë¡œ, ì¢€ë¹„ë¥¼Â **ë³´ë‚´ëŠ”**Â ì‚¬ëŒ(`address _from`)ì˜Â `ownerZombieCount`ë¥¼ ê°ì†Œì‹œì¼œì•¼ í•˜ë„¤. ê°ì†Œì‹œí‚¬ ë•ŒÂ `-`ë¥¼ ì“°ë„ë¡ í•˜ê²Œ.
    4. ì´Â `_tokenId`ì— í•´ë‹¹í•˜ëŠ”Â `zombieToOwner`Â ë§¤í•‘ ê°’ì´Â `_to`ë¥¼ ê°€ë¦¬í‚¤ë„ë¡ ë³€ê²½.
    5. ERC721 ìŠ¤í™ì—ëŠ”Â `Transfer`Â ì´ë²¤íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆë„¤. ì´ í•¨ìˆ˜ì˜ ë§ˆì§€ë§‰ ì¤„ì—ì„œ ì ì ˆí•œ ì •ë³´ì™€ í•¨ê»˜Â `Transfer`ë¥¼ ì‹¤í–‰í•´ì•¼ í•˜ë„¤ -Â `erc721.sol`ì„ ë³´ê³  ì–´ë–¤ ì¸ìˆ˜ë“¤ì´ í•„ìš”í•œì§€ í™•ì¸í•œ í›„ ì—¬ê¸°ì— ê·¸ê±¸ êµ¬í˜„.
    - ì˜ˆì œ ì½”ë“œ
        
        ```solidity
        pragma solidity ^0.4.19;
        
        import "./zombieattack.sol";
        import "./erc721.sol";
        
        contract ZombieOwnership is ZombieAttack, ERC721 {
        
          function balanceOf(address _owner) public view returns (uint256 _balance) {
            return ownerZombieCount[_owner];
          }
        
          function ownerOf(uint256 _tokenId) public view returns (address _owner) {
            return zombieToOwner[_tokenId];
          }
        
          // ì—¬ê¸°ì— _transfer()ë¥¼ ì •ì˜í•˜ê²Œ.
          function _transfer(address _from, address _to, uint256 _tokenId) private {
              ownerZombieCount[_to]++;
              ownerZombieCount[_from]--;
              zombieToOwner[_tokenId] = _to;
              Transfer(_from, _to, _tokenId);
          }
        
          function transfer(address _to, uint256 _tokenId) public {
        
          }
        
          function approve(address _to, uint256 _tokenId) public {
        
          }
        
          function takeOwnership(uint256 _tokenId) public {
        
          }
        }
        ```
        
- ì˜ˆì œ2 ) í¼ë¸”ë¦­Â `transfer`í•¨ìˆ˜ë¥¼ êµ¬í˜„
    1. ìš°ë¦¬ëŠ” í† í°/ì¢€ë¹„ì˜ ì†Œìœ ìë§Œ í•´ë‹¹ í† í°/ì¢€ë¹„ë¥¼ ì „ì†¡í•  ìˆ˜ ìˆë„ë¡ í•˜ê³  ì‹¶ë„¤. ìë„¤, ì–´ë–»ê²Œ ê·¸ ì†Œìœ ìë§Œ ì´ í•¨ìˆ˜ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ì œí•œí•˜ëŠ”ì§€ ê¸°ì–µí•˜ê³  ìˆë‚˜?
        
        ê·¸ë˜, ë°”ë¡œ ê·¸ê±°ì§€. ìš°ë¦¬ëŠ” ì´ë¯¸ ì´ë ‡ê²Œ ë§Œë“¤ì–´ì£¼ëŠ” ì œì–´ìë¥¼ ê°€ì§€ê³  ìˆë„¤. ê·¸ëŸ¬ë‹ˆ ì´ í•¨ìˆ˜ì—Â `onlyOwnerOf`Â ì œì–´ìë¥¼ ì¶”ê°€í•˜ê²Œ.
        
    2. ì´ì œ í•¨ìˆ˜ì˜ ë‚´ìš©ì€ ì§„ì§œë¡œ ë”± í•œ ì¤„ì´ë©´ ë˜ë„¤... ê·¸ì €Â `_transfer`ë¥¼ í˜¸ì¶œí•˜ê¸°ë§Œ í•˜ë©´ ë˜ì§€.Â `address _from`Â ì¸ìˆ˜ì—Â `msg.sender`ë¥¼ ì „ë‹¬í•˜ëŠ” ê²ƒì„ ìŠì§€ ë§ê²Œ. 
    - ì˜ˆì œ2 ì½”ë“œ
        
        ```solidity
        pragma solidity ^0.4.19;
        
        import "./zombieattack.sol";
        import "./erc721.sol";
        
        contract ZombieOwnership is ZombieAttack, ERC721 {
        
          function balanceOf(address _owner) public view returns (uint256 _balance) {
            return ownerZombieCount[_owner];
          }
        
          function ownerOf(uint256 _tokenId) public view returns (address _owner) {
            return zombieToOwner[_tokenId];
          }
        
          function _transfer(address _from, address _to, uint256 _tokenId) private {
            ownerZombieCount[_to]++;
            ownerZombieCount[_from]--;
            zombieToOwner[_tokenId] = _to;
            Transfer(_from, _to, _tokenId);
          }
        
          // 1. ì—¬ê¸°ì— ì œì–´ìë¥¼ ì¶”ê°€í•˜ê²Œ.
          function transfer(address _to, uint256 _tokenId) public onlyOwnerOf(_tokenId) {
            // 2. ì—¬ê¸°ì„œ í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ê²Œ.
            _transfer(msg.sender, _to, _tokenId);
          }
        
          function approve(address _to, uint256 _tokenId) public {
        
          }
        
          function takeOwnership(uint256 _tokenId) public {
        
          }
        }
        ```
        

### ERC721: Approve

- approve
    - `approve`/Â `takeOwnership`ì„ ì‚¬ìš©í•˜ëŠ” ì „ì†¡ì€ 2ë‹¨ê³„ë¡œ ë‚˜ë‰¨
        1. ì†Œìœ ìì¸ ìë„¤ê°€ ìƒˆë¡œìš´ ì†Œìœ ìì˜Â `address`ì™€ ê·¸ì—ê²Œ ë³´ë‚´ê³  ì‹¶ì€Â `_tokenId`ë¥¼ ì‚¬ìš©í•˜ì—¬Â `approve`ë¥¼ í˜¸ì¶œ.
        2. ìƒˆë¡œìš´ ì†Œìœ ìê°€Â `_tokenId`ë¥¼ ì‚¬ìš©í•˜ì—¬Â `takeOwnership`Â í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´, ì»¨íŠ¸ë™íŠ¸ëŠ” ê·¸ê°€ ìŠ¹ì¸ëœ ìì¸ì§€ í™•ì¸í•˜ê³  ê·¸ì—ê²Œ í† í°ì„ ì „ì†¡.
    - ì´ì²˜ëŸ¼ 2ë²ˆì˜ í•¨ìˆ˜ í˜¸ì¶œì´ ë°œìƒí•˜ê¸° ë•Œë¬¸ì—, í•¨ìˆ˜ í˜¸ì¶œ ì‚¬ì´ì— ëˆ„ê°€ ë¬´ì—‡ì— ëŒ€í•´ ìŠ¹ì¸ì´ ë˜ì—ˆëŠ”ì§€ ì €ì¥í•  ë°ì´í„° êµ¬ì¡°ê°€ í•„ìš”í•  ê²ƒ
- ì˜ˆì œ)
    1. ë¨¼ì €,Â `zombieApprovals`Â ë§¤í•‘ì„ ì •ì˜í•´ë³´ë„ë¡ í•˜ì§€. ì´ê²ƒì€Â `uint`ë¥¼Â `address`ë¡œ ì—°ê²°í•˜ì—¬ì•¼ í•˜ë„¤.
        
        ì´ëŸ° ë°©ì‹ìœ¼ë¡œ, ëˆ„êµ°ê°€Â `_tokenId`ë¡œÂ `takeOwnership`ì„ í˜¸ì¶œí•˜ë©´, ì´ ë§¤í•‘ì„ ì¨ì„œ ëˆ„ê°€ ê·¸ í† í°ì„ ê°€ì§€ë„ë¡ ìŠ¹ì¸ë°›ì•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë„¤.
        
    2. `approve`Â í•¨ìˆ˜ì—ì„œ, ìš°ë¦¬ëŠ” ì˜¤ì§ ê·¸ í† í°ì˜ ì†Œìœ ìë§Œ ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ í† í°ì„ ì¤„ ìˆ˜ ìˆëŠ” ìŠ¹ì¸ì„ í•  ìˆ˜ ìˆë„ë¡ í•˜ê³  ì‹¶ë„¤. ê·¸ëŸ¬ë‹ˆÂ `approve`ì—Â `onlyOwnerOf`Â ì œì–´ìë¥¼ ì¶”ê°€í•´ì•¼ í•  ê²ƒì´ë„¤.
    3. í•¨ìˆ˜ì˜ ë‚´ìš©ì—ì„œëŠ”Â `zombieApprovals`ì˜Â `_tokenId`Â ìš”ì†Œë¥¼Â `_to`Â ì£¼ì†Œì™€ ê°™ë„ë¡ ë§Œë“¤ê²Œ.
    4. ë§ˆì§€ë§‰ìœ¼ë¡œ, ERC721 ìŠ¤í™ì—Â `Approval`Â ì´ë²¤íŠ¸ê°€ ìˆë„¤. ê·¸ëŸ¬ë‹ˆ ìš°ë¦¬ëŠ” ì´ í•¨ìˆ˜ì˜ ë§ˆì§€ë§‰ì—ì„œ ì´ ì´ë²¤íŠ¸ë¥¼ í˜¸ì¶œí•´ì•¼ í•˜ë„¤.Â `erc721.sol`ì—ì„œ ì¸ìˆ˜ë¥¼ í™•ì¸í•˜ê³ ,Â `msg.sender`ë¥¼Â `_owner`ì— ì“°ë„ë¡ í•˜ê²Œ. 
    - ì˜ˆì œ ì½”ë“œ
        
        ```solidity
        pragma solidity ^0.4.19;
        
        import "./zombieattack.sol";
        import "./erc721.sol";
        
        contract ZombieOwnership is ZombieAttack, ERC721 {
        
          // 1. ì—¬ê¸°ì— mappingì„ ì •ì˜í•˜ê²Œ.
          mapping (uint => address) zombieApprovals;
        
          function balanceOf(address _owner) public view returns (uint256 _balance) {
            return ownerZombieCount[_owner];
          }
        
          function ownerOf(uint256 _tokenId) public view returns (address _owner) {
            return zombieToOwner[_tokenId];
          }
        
          function _transfer(address _from, address _to, uint256 _tokenId) private {
            ownerZombieCount[_to]++;
            ownerZombieCount[_from]--;
            zombieToOwner[_tokenId] = _to;
            Transfer(_from, _to, _tokenId);
          }
        
          function transfer(address _to, uint256 _tokenId) public onlyOwnerOf(_tokenId) {
            _transfer(msg.sender, _to, _tokenId);
          }
        
          // 2. ì—¬ê¸°ì— í•¨ìˆ˜ ì œì–´ìë¥¼ ì¶”ê°€í•˜ê²Œ.
          function approve(address _to, uint256 _tokenId) public onlyOwnerOf(_tokenId) {
            // 3. ì—¬ê¸°ì„œ í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ê²Œ.
            zombieApprovals[_tokenId] = _to;
            Approval(msg.sender, _to, _tokenId);
          }
        
          function takeOwnership(uint256 _tokenId) public {
        
          }
        }
        ```
        

### ****ERC721: takeOwnership****

- ë§ˆì§€ë§‰ í•¨ìˆ˜ì¸Â `takeOwnership`ì—ì„œëŠ”Â `msg.sender`ê°€ ì´ í† í°/ì¢€ë¹„ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë„ë¡ ìŠ¹ì¸ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê³ , ìŠ¹ì¸ì´ ë˜ì—ˆë‹¤ë©´Â `_transfer`ë¥¼ í˜¸ì¶œ
- ì˜ˆì œ)
    1. ë¨¼ì €,Â `require`Â ë¬¸ì¥ì„ ì¨ì„œÂ `zombieApprovals`ì˜Â `_tokenId`Â ìš”ì†Œê°€Â `msg.sender`ì™€ ê°™ì€ì§€ í™•ì¸í•´ì•¼ í•˜ë„¤.
        
        ì´ëŸ° ë°©ì‹ìœ¼ë¡œ ë§Œì•½Â `msg.sender`ê°€ ì´ í† í°ì„ ë°›ë„ë¡ ìŠ¹ì¸ë˜ì§€ ì•Šì•˜ë‹¤ë©´, ì—ëŸ¬ë¥¼ ë§Œë“¤ì–´ë‚¼ ê²ƒì´ë„¤.
        
    2. `_transfer`ë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´, ìš°ë¦¬ëŠ” ê·¸ í† í°ì„ ì†Œìœ í•œ ì‚¬ëŒì˜ ì£¼ì†Œë¥¼ ì•Œ í•„ìš”ê°€ ìˆë„¤(í•¨ìˆ˜ì—ì„œÂ `_from`ì„ ì¸ìˆ˜ë¡œ ìš”êµ¬í•˜ê¸° ë–„ë¬¸ì´ì§€). ë‹¤í–‰íˆ ìš°ë¦¬ì˜Â `ownerOf`Â í•¨ìˆ˜ë¥¼ ì¨ì„œ ì´ë¥¼ ì°¾ì•„ë‚¼ ìˆ˜ ìˆë„¤.
        
        ê·¸ëŸ¬ë‹ˆÂ `address`Â ë³€ìˆ˜ë¥¼Â `owner`ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì„ ì–¸í•˜ê³ , ì—¬ê¸°ì—Â `ownerOf(_tokenId)`ë¥¼ ëŒ€ì…í•˜ê²Œ.
        
    3. ë§ˆì§€ë§‰ìœ¼ë¡œ,Â `_transfer`ë¥¼ í•„ìš”í•œ ëª¨ë“  ì •ë³´ì™€ í•¨ê»˜ í˜¸ì¶œí•˜ê²Œ(ì—¬ê¸°ì„œëŠ”Â `msg.sender`ë¥¼Â `_to`ì— ì‚¬ìš©í•˜ë©´ ë˜ë„¤. ì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ì‚¬ëŒì´ í† í°ì„ ë°›ì„ ì‚¬ëŒì´ê¸° ë–„ë¬¸ì´ì§€).
    
    > ì°¸ê³ : 2ë²ˆì§¸ì™€ 3ë²ˆì§¸ ë‹¨ê³„ë¥¼ í•œ ì¤„ì˜ ì½”ë“œë¡œ ë§Œë“¤ ìˆ˜ ìˆì§€ë§Œ, ë‚˜ëˆ„ëŠ” ê²ƒì´ ì¡°ê¸ˆ ë” ì½ê¸° ì¢‹ê²Œ ë§Œë“¬. ê°œì¸ì ì¸ ì„ í˜¸.
    > 
    - ì˜ˆì œ ì½”ë“œ
        
        ```solidity
        pragma solidity ^0.4.19;
        
        import "./zombieattack.sol";
        import "./erc721.sol";
        
        contract ZombieOwnership is ZombieAttack, ERC721 {
        
          mapping (uint => address) zombieApprovals;
        
          function balanceOf(address _owner) public view returns (uint256 _balance) {
            return ownerZombieCount[_owner];
          }
        
          function ownerOf(uint256 _tokenId) public view returns (address _owner) {
            return zombieToOwner[_tokenId];
          }
        
          function _transfer(address _from, address _to, uint256 _tokenId) private {
            ownerZombieCount[_to]++;
            ownerZombieCount[_from]--;
            zombieToOwner[_tokenId] = _to;
            Transfer(_from, _to, _tokenId);
          }
        
          function transfer(address _to, uint256 _tokenId) public onlyOwnerOf(_tokenId) {
            _transfer(msg.sender, _to, _tokenId);
          }
        
          function approve(address _to, uint256 _tokenId) public onlyOwnerOf(_tokenId) {
            zombieApprovals[_tokenId] = _to;
            Approval(msg.sender, _to, _tokenId);
          }
        
          function takeOwnership(uint256 _tokenId) public {
            // ì—¬ê¸°ì„œ ì‹œì‘í•˜ê²Œ.
            require(zombieApprovals[_tokenId] == msg.sender);
            address owner = ownerOf(_tokenId);
            _transfer(owner, msg.sender, _tokenId);
          }
        }
        ```
        

### ì˜¤ë²„í”Œë¡œìš°

- ì»¨íŠ¸ë™íŠ¸ ë³´ì•ˆ ê°•í™” : ì˜¤ë²„í”Œë¡œìš°ì™€ ì–¸ë”í”Œë¡œìš°
    - ì˜¤ë²„í”Œë¡œìš°: ë³€ìˆ˜ì— íƒ€ì… ë³´ë‹¤ í° ê°’ì„ ë„£ëŠ”ê²ƒ
    - ì–¸ë”í”Œë¡œìš° : `0`ê°’ì„ ê°€ì§„Â `uint8`ì—ì„œÂ `1`ì„ ë¹¼ë©´,Â `255`ì™€ ê°™ì•„ì§€ëŠ” ê²ƒ

### SafeMath ì‚¬ìš©í•˜ê¸°

- ì˜¤ë²„í”Œë¡œìš°ë‚˜, ì–¸ë”í”Œë¡œìš°ë¥¼ ë§‰ê¸° ìœ„í•´ `SafeMath` ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
- ***ë¼ì´ë¸ŒëŸ¬ë¦¬(Library)***ëŠ” ì†”ë¦¬ë””í‹°ì—ì„œ íŠ¹ë³„í•œ ì¢…ë¥˜ì˜ ì»¨íŠ¸ë™íŠ¸
    - ìœ ìš©í•˜ê²Œ ì‚¬ìš©ë˜ëŠ” ê²½ìš° ì¤‘ í•˜ë‚˜ëŠ” ê¸°ë³¸(native) ë°ì´í„° íƒ€ì…ì— í•¨ìˆ˜ë¥¼ ë¶™ì¼ ë•Œ
    - afeMath ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì“¸ ë•ŒëŠ”Â `using SafeMath for uint256`ì´ë¼ëŠ” êµ¬ë¬¸ì„ ì‚¬ìš©
    - SafeMath ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” 4ê°œì˜ í•¨ìˆ˜ : `add`,Â `sub`,Â `mul`, Â `div`
- ì˜ˆì œ)ì»¨íŠ¸ë™íŠ¸ê°€ SafeMath ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì“°ë„ë¡ ë§Œë“ ë‹¤.
    1. `safemath.sol`ì„Â `zombiefactory.sol`ì— ì„í¬íŠ¸.
    2. `using SafeMath for uint256;`Â ì„ ì–¸ì„ ì¶”ê°€.
    - ì˜ˆì œ ì½”ë“œ
        
        ```solidity
        pragma solidity ^0.4.19;
        
        import "./ownable.sol";
        // 1. ì—¬ê¸°ì„œ import í•˜ê²Œ.
        import "./safemath.sol";
        
        contract ZombieFactory is Ownable {
        
          // 2. ì—¬ê¸°ì— using safemathë¥¼ ì„ ì–¸í•˜ê²Œ.
          using SafeMath for uint256;
        
          event NewZombie(uint zombieId, string name, uint dna);
        
          uint dnaDigits = 16;
          uint dnaModulus = 10 ** dnaDigits;
          uint cooldownTime = 1 days;
        
          struct Zombie {
            string name;
            uint dna;
            uint32 level;
            uint32 readyTime;
            uint16 winCount;
            uint16 lossCount;
          }
        
          Zombie[] public zombies;
        
          mapping (uint => address) public zombieToOwner;
          mapping (address => uint) ownerZombieCount;
        
          function _createZombie(string _name, uint _dna) internal {
            uint id = zombies.push(Zombie(_name, _dna, 1, uint32(now + cooldownTime), 0, 0)) - 1;
            zombieToOwner[id] = msg.sender;
            ownerZombieCount[msg.sender]++;
            NewZombie(id, _name, _dna);
          }
        
          function _generateRandomDna(string _str) private view returns (uint) {
            uint rand = uint(keccak256(_str));
            return rand % dnaModulus;
          }
        
          function createRandomZombie(string _name) public {
            require(ownerZombieCount[msg.sender] == 0);
            uint randDna = _generateRandomDna(_name);
            randDna = randDna - randDna % 100;
            _createZombie(_name, randDna);
          }
        
        }
        ```
        

### SafeMath ë‚´ë¶€ì½”ë“œ

```solidity
library SafeMath {

  function mul(uint256 a, uint256 b) internal pure returns (uint256) {
    if (a == 0) {
      return 0;
    }
    uint256 c = a * b;
    assert(c / a == b);
    return c;
  }

  function div(uint256 a, uint256 b) internal pure returns (uint256) {
    // assert(b > 0); // Solidity automatically throws when dividing by 0
    uint256 c = a / b;
    // assert(a == b * c + a % b); // There is no case in which this doesn't hold
    return c;
  }

  function sub(uint256 a, uint256 b) internal pure returns (uint256) {
    assert(b <= a);
    return a - b;
  }

  function add(uint256 a, uint256 b) internal pure returns (uint256) {
    uint256 c = a + b;
    assert(c >= a);
    return c;
  }
}
```

- `library`í‚¤ì›Œë“œ :
    - `contract`ì™€ ë¹„ìŠ·í•˜ì§€ë§Œ ë‹¤ë¥¸ ì , ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ìš°ë¦¬ê°€Â `using`í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤Œ.
    - ì´ë¥¼ í†µí•´ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ë©”ì†Œë“œë“¤ì„ ë‹¤ë¥¸ ë°ì´í„° íƒ€ì…ì— ì ìš©.

```solidity
using SafeMath for uint;
// ìš°ë¦¬ëŠ” ì´ì œ ì´ ë©”ì†Œë“œë“¤ì„ ì•„ë¬´ uintì—ì„œë‚˜ ì“¸ ìˆ˜ ìˆë„¤.
uint test = 2;
test = test.mul(3); // testëŠ” ì´ì œ 6ì´ ë˜ë„¤
test = test.add(5); // testëŠ” ì´ì œ 11ì´ ë˜ë„¤
```

- `mul`ê³¼Â `add`í•¨ìˆ˜ëŠ” ê°ê° 2ê°œì˜ ì¸ìˆ˜ë¥¼ í•„ìš”. í•˜ì§€ë§Œ ì¸ìˆ˜ 1ê°œë§Œ ë„˜ê¹€
    - `using SafeMath for uint`ë¥¼ ì„ ì–¸í•  ë•Œ, í•¨ìˆ˜ë¥¼ ì ìš©í•˜ëŠ”Â `uint`(`test`)ëŠ” ì²« ë²ˆì§¸ ì¸ìˆ˜ë¡œ ìë™ìœ¼ë¡œ ì „ë‹¬
- `add`í•¨ìˆ˜
    
    ```solidity
    function add(uint256 a, uint256 b) internal pure returns (uint256) {
      uint256 c = a + b;
      assert(c >= a);
      return c;
    }
    ```
    
    - `**assert`Â êµ¬ë¬¸ì„ ì¨ì„œ ê·¸ í•©ì´Â `a`ë³´ë‹¤ í¬ë„ë¡ ë³´ì¥í•˜ì§€. ì´ê²ƒì´ ì˜¤ë²„í”Œë¡œìš°ë¥¼ ë§‰ì•„ì¤Œ**
- **assert**
    - `assert`ì™€ `require` ì˜ ê³µí†µì  :
        - ì¡°ê±´ì„ ë§Œì¡±í•˜ì§€ ì•Šìœ¼ë©´ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¨ë‹¤ëŠ” ì ì—ì„œ ë¹„ìŠ·
    - `assert`ì™€Â `require`ì˜ ì°¨ì´ì  :
        - `require`ëŠ” í•¨ìˆ˜ ì‹¤í–‰ì´ ì‹¤íŒ¨í•˜ë©´ ë‚¨ì€ **ê°€ìŠ¤**ë¥¼ ì‚¬ìš©ìì—ê²Œ ë˜ëŒë ¤ ì¤Œ
        - `assert`ëŠ” ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” ê²ƒ
    - `assert`ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì½”ë“œê°€ **ì‹¬ê°í•˜ê²Œ** ì˜ëª» ì‹¤í–‰ë  ë•Œ ì‚¬ìš©
        - ex)`uint`ì˜¤ë²„í”Œë¡œìš°
- ì˜ˆì œ) ì˜¤ë²„í”Œë¡œìš°ë‚˜ ì–¸ë”í”Œë¡œìš°ë¥¼ ë§‰ê¸° ìœ„í•´, ì½”ë“œì—ì„œÂ `+`,Â `-`,Â `*`Â ë˜ëŠ”Â `/`ì„ ì“°ëŠ” ê³³ì„ ì°¾ì•„Â `add`,Â `sub`,Â `mul`,Â `div`ë¡œ êµì²´
    1. `++`ë¥¼ SafeMath ë©”ì†Œë“œë¡œ êµì²´í•˜ê²Œ.
    2. `-`ë¥¼ SafeMath ë©”ì†Œë“œë¡œ êµì²´í•˜ê²Œ. 
    - ì˜ˆì œ ì½”ë“œ
        
        ```solidity
        pragma solidity ^0.4.19;
        
        import "./zombieattack.sol";
        import "./erc721.sol";
        import "./safemath.sol";
        
        contract ZombieOwnership is ZombieAttack, ERC721 {
        
          using SafeMath for uint256;
        
          mapping (uint => address) zombieApprovals;
        
          function balanceOf(address _owner) public view returns (uint256 _balance) {
            return ownerZombieCount[_owner];
          }
        
          function ownerOf(uint256 _tokenId) public view returns (address _owner) {
            return zombieToOwner[_tokenId];
          }
        
          function _transfer(address _from, address _to, uint256 _tokenId) private {
            // 1. SafeMathì˜ `add`ë¡œ êµì²´í•˜ê²Œ.
            ownerZombieCount[_to] = ownerZombieCount[_to].add(1);
            // 2. SafeMathì˜ `sub`ë¡œ êµì²´í•˜ê²Œ.
            ownerZombieCount[_from] = ownerZombieCount[_from].sub(1);
            zombieToOwner[_tokenId] = _to;
            Transfer(_from, _to, _tokenId);
          }
        
          function transfer(address _to, uint256 _tokenId) public onlyOwnerOf(_tokenId) {
            _transfer(msg.sender, _to, _tokenId);
          }
        
          function approve(address _to, uint256 _tokenId) public onlyOwnerOf(_tokenId) {
            zombieApprovals[_tokenId] = _to;
            Approval(msg.sender, _to, _tokenId);
          }
        
          function takeOwnership(uint256 _tokenId) public {
            require(zombieApprovals[_tokenId] == msg.sender);
            address owner = ownerOf(_tokenId);
            _transfer(owner, msg.sender, _tokenId);
          }
        }
        ```
        

### ****SafeMath (ë³€ìˆ˜íƒ€ì…ì´ ë‹¤ë¥¸ ê²½ìš°)****

- `uint16`, `uint32` íƒ€ì…ì˜ ì¸ìˆ˜ë¥¼ ì¨ì„œ **SefeMath**ì˜ `add` ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ë©´, ì´ íƒ€ì…ë“¤ì„ `uint256` ìœ¼ë¡œ ë°”ê¾¸ê¸° ë•Œë¬¸ì— ì˜¤ë²„í”Œë¡œìš°ë¥¼ ë§‰ì•„ì£¼ì§€ ëª»í•¨
- `uint16`ê³¼Â `uint32`ì—ì„œ ì˜¤ë²„í”Œë¡œìš°/ì–¸ë”í”Œë¡œìš°ë¥¼ ë§‰ê¸° ìœ„í•´ 2ê°œì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë” ë§Œë“¤ì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸
- `using SafeMath for uint256;` : `uint256`ë³€ìˆ˜íƒ€ì…ì— `SafeMath` ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
- `using SafeMath32 for uint32;` : `uint32`ë³€ìˆ˜íƒ€ì…ì— `SafeMath32` ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
- `using SafeMath16 for uint16;` : `uint16`ë³€ìˆ˜íƒ€ì…ì— `SafeMath16` ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
- ì˜ˆì œ)
    1. ìš°ë¦¬ê°€Â `SafeMath32`ë¥¼Â `uint32`ì— ì“´ë‹¤ëŠ” ê²ƒì„ ì„ ì–¸í•˜ê²Œ.
    2. ìš°ë¦¬ê°€Â `SafeMath16`ì„Â `uint16`ì— ì“´ë‹¤ëŠ” ê²ƒì„ ì„ ì–¸í•˜ê²Œ.
    3. ZombieFactoryì— SafeMath ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•´ì•¼ í•  ê³³ì´ í•œ ì¤„ ë” ìˆë„¤. ì–´ë”˜ì§€ ê°€ë¦¬í‚¤ëŠ” ì£¼ì„ì„ ë‚¨ê²¨ë†“ì•˜ë„¤. 
    - ì˜ˆì œ ì½”ë“œ
        
        ```solidity
        pragma solidity ^0.4.19;
        
        import "./ownable.sol";
        import "./safemath.sol";
        
        contract ZombieFactory is Ownable {
        
          using SafeMath for uint256;
          // 1. using SafeMath32 for uint32ë¥¼ ì„ ì–¸í•˜ê²Œ.
          using SafeMath32 for uint32;
          // 2. using SafeMath16 for uint16ë¥¼ ì„ ì–¸í•˜ê²Œ.
          using SafeMath16 for uint16;
        
          event NewZombie(uint zombieId, string name, uint dna);
        
          uint dnaDigits = 16;
          uint dnaModulus = 10 ** dnaDigits;
          uint cooldownTime = 1 days;
        
          struct Zombie {
            string name;
            uint dna;
            uint32 level;
            uint32 readyTime;
            uint16 winCount;
            uint16 lossCount;
          }
        
          Zombie[] public zombies;
        
          mapping (uint => address) public zombieToOwner;
          mapping (address => uint) ownerZombieCount;
        
          function _createZombie(string _name, uint _dna) internal {
            // ì°¸ê³ : ìš°ë¦¬ëŠ” Year 2038 ë¬¸ì œë¥¼ ë§‰ì§€ ì•Šê¸°ë¡œ í•˜ê² ë„¤... ê·¸ëŸ¬ë‹ˆ readyTimeì—ì„œ ì˜¤ë²„í”Œë¡œìš°ë¥¼ ê±±ì •í•  í•„ìš”ëŠ” ì—†ë„¤.
            // ìš°ë¦¬ ì•±ì€ 2038ë…„ì—ëŠ” ì¢€ ê¼¬ì´ê² ì§€ ;)
            uint id = zombies.push(Zombie(_name, _dna, 1, uint32(now + cooldownTime), 0, 0)) - 1;
            zombieToOwner[id] = msg.sender;
            // 3. ì—¬ê¸°ì— SafeMathì˜ `add`ë¥¼ ì‚¬ìš©í•˜ê²Œ:
            ownerZombieCount[msg.sender] = ownerZombieCount[msg.sender].add(1);
            NewZombie(id, _name, _dna);
          }
        
          function _generateRandomDna(string _str) private view returns (uint) {
            uint rand = uint(keccak256(_str));
            return rand % dnaModulus;
          }
        
          function createRandomZombie(string _name) public {
            require(ownerZombieCount[msg.sender] == 0);
            uint randDna = _generateRandomDna(_name);
            randDna = randDna - randDna % 100;
            _createZombie(_name, randDna);
          }
        
        }
        ```
        
- ì˜ˆì œ2)
    - `ZombieAttack`ì—ì„œÂ `++`Â ì¦ê°€ ë¶€ë¶„ì„ SafeMath ë©”ì†Œë“œë¡œ êµ¬ì„±
    - ì˜ˆì œ ì½”ë“œ
        
        ```solidity
        pragma solidity ^0.4.19;
        
        import "./zombiehelper.sol";
        
        contract ZombieAttack is ZombieHelper {
          uint randNonce = 0;
          uint attackVictoryProbability = 70;
        
          function randMod(uint _modulus) internal returns(uint) {
            // ì—¬ê¸° í•˜ë‚˜ ìˆë„¤!
            randNonce = randNonce.add(1);
            return uint(keccak256(now, msg.sender, randNonce)) % _modulus;
          }
        
          function attack(uint _zombieId, uint _targetId) external onlyOwnerOf(_zombieId) {
            Zombie storage myZombie = zombies[_zombieId];
            Zombie storage enemyZombie = zombies[_targetId];
            uint rand = randMod(100);
            if (rand <= attackVictoryProbability) {
              // ì—¬ê¸° ì„¸ ê°œ ë” ìˆêµ°!
              myZombie.winCount = myZombie.winCount.add(1);
              myZombie.level = myZombie.level.add(1);
              enemyZombie.lossCount = enemyZombie.lossCount.add(1);
              feedAndMultiply(_zombieId, enemyZombie.dna, "zombie");
            } else {
              // ...ê·¸ë¦¬ê³  2ê°œ ë”!
              myZombie.lossCount = myZombie.lossCount.add(1);
              enemyZombie.winCount = enemyZombie.winCount.add(1);
              _triggerCooldown(myZombie);
            }
          }
        }
        ```
        

### ì£¼ì„

- ****ì£¼ì„ì„ ìœ„í•œ ë¬¸ë²•****
    - `//` : í•œì¤„ ì£¼ì„
    - `/* */` : ì—¬ëŸ¬ ì¤„ ì£¼ì„
- ì†”ë¦¬ë””í‹° ì»¤ë®¤ë‹ˆí‹°ì—ì„œ í‘œì¤€ìœ¼ë¡œ ì“°ì´ëŠ” í˜•ì‹ì€Â ***natspec***
    
    ```solidity
    /// @title ê¸°ë³¸ì ì¸ ì‚°ìˆ˜ë¥¼ ìœ„í•œ ì»¨íŠ¸ë™íŠ¸
    /// @author H4XF13LD MORRIS ğŸ’¯ğŸ’¯ğŸ˜ğŸ’¯ğŸ’¯
    /// @notice ì§€ê¸ˆì€ ê³±í•˜ê¸° í•¨ìˆ˜ë§Œ ì¶”ê°€í•œë‹¤.
    contract Math {
      /// @notice 2ê°œì˜ ìˆ«ìë¥¼ ê³±í•œë‹¤.
      /// @param x ì²« ë²ˆì¨° uint.
      /// @param y ë‘ ë²ˆì§¸ uint.
      /// @return z (x * y) ê³±ì˜ ê°’
      /// @dev ì´ í•¨ìˆ˜ëŠ” í˜„ì¬ ì˜¤ë²„í”Œë¡œìš°ë¥¼ í™•ì¸í•˜ì§€ ì•ŠëŠ”ë‹¤.
      function multiply(uint x, uint y) returns (uint z) {
        // ì´ê²ƒì€ ì¼ë°˜ì ì¸ ì£¼ì„ìœ¼ë¡œ, natspecì— í¬í•¨ë˜ì§€ ì•ŠëŠ”ë‹¤.
        z = x * y;
      }
    }
    ```
    
    - `@notice`ëŠ”Â **ì‚¬ìš©ì**ì—ê²Œ ì»¨íŠ¸ë™íŠ¸/í•¨ìˆ˜ê°€ ë¬´ì—‡ì„ í•˜ëŠ”ì§€ ì„¤ëª…
    - `@dev`ëŠ” ê°œë°œìì—ê²Œ ì¶”ê°€ì ì¸ ìƒì„¸ ì •ë³´ë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´ ì‚¬ìš©
    - `@param`ê³¼Â `@return`ì€ í•¨ìˆ˜ì—ì„œ ì–´ë–¤ ë§¤ê°œ ë³€ìˆ˜ì™€ ë°˜í™˜ê°’ì„ ê°€ì§€ëŠ”ì§€ ì„¤ëª…
- ì˜ˆì œ) `ZombieOwnership`ì— natspec íƒœê·¸ë¥¼ ì¶”ê°€
    1. `@title`Â - ì˜ˆë¥¼ ë“¤ì–´, ì¢€ë¹„ ì†Œìœ ê¶Œ ì „ì†¡ì„ ê´€ë¦¬í•˜ëŠ” ì»¨íŠ¸ë™íŠ¸ë¼ê³  ì“°ê²Œ.
    2. `@author`Â - ìë„¤ì˜ ì´ë¦„!
    3. `@dev`Â - ì˜ˆë¥¼ ë“¤ì–´, OpenZeppelinì˜ ERC721 í‘œì¤€ ì´ˆì•ˆ êµ¬í˜„ì„ ë”°ë¥¸ë‹¤ê³  í•˜ê²Œ.
    - ì˜ˆì œ ì½”ë“œ)
        
        ```solidity
        pragma solidity ^0.4.19;
        
        import "./zombieattack.sol";
        import "./erc721.sol";
        import "./safemath.sol";
        
        /// TODO: natspecì— ë§ë„ë¡ ì´ ë¶€ë¶„ì„ ë°”ê¾¸ê²Œ.
        //@title ì¢€ë¹„ ì†Œìœ ê¶Œ ì „ì†¡ì„ ê´€ë¦¬í•˜ëŠ” ì»¨íŠ¸ë™íŠ¸
        //@author myang><
        //@dev OpenZeppelinì˜ ERC721 í‘œì¤€ ì´ˆì•ˆ êµ¬í˜„ì„ ë”°ë¥¸ë‹¤
        contract ZombieOwnership is ZombieAttack, ERC721 {
        
          using SafeMath for uint256;
        
          mapping (uint => address) zombieApprovals;
        
          function balanceOf(address _owner) public view returns (uint256 _balance) {
            return ownerZombieCount[_owner];
          }
        
          function ownerOf(uint256 _tokenId) public view returns (address _owner) {
            return zombieToOwner[_tokenId];
          }
        
          function _transfer(address _from, address _to, uint256 _tokenId) private {
            ownerZombieCount[_to] = ownerZombieCount[_to].add(1);
            ownerZombieCount[msg.sender] = ownerZombieCount[msg.sender].sub(1);
            zombieToOwner[_tokenId] = _to;
            Transfer(_from, _to, _tokenId);
          }
        
          function transfer(address _to, uint256 _tokenId) public onlyOwnerOf(_tokenId) {
            _transfer(msg.sender, _to, _tokenId);
          }
        
          function approve(address _to, uint256 _tokenId) public onlyOwnerOf(_tokenId) {
            zombieApprovals[_tokenId] = _to;
            Approval(msg.sender, _to, _tokenId);
          }
        
          function takeOwnership(uint256 _tokenId) public {
            require(zombieApprovals[_tokenId] == msg.sender);
            address owner = ownerOf(_tokenId);
            _transfer(owner, msg.sender, _tokenId);
          }
        }
        ```
        

### ë§ˆë¬´ë¦¬

- í† í°, ERC721 í‘œì¤€, ê·¸ë¦¬ê³  ê±°ë˜í•  ìˆ˜ ìˆëŠ” ìì‚°/ì¢€ë¹„
- ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ ì´ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
- SafeMath ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜¤ë²„í”Œë¡œìš°ì™€ ì–¸ë”í”Œë¡œìš°ë¥¼ ë§‰ëŠ” ë°©ë²•
- ì½”ë“œì— ì£¼ì„ì„ ì¶”ê°€í•˜ëŠ” ë°©ë²•ê³¼ natspec í‘œì¤€